<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NotebookLM 슬라이드 폰트 수정기</title>
  <meta name="description" content="NotebookLM에서 생성된 PDF 슬라이드의 깨진 한글을 수정하는 웹 도구">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="header-logo">
      <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
        <polyline points="10 9 9 9 8 9"></polyline>
      </svg>
      <h1>NotebookLM 폰트 수정기</h1>
    </div>
    <div class="header-actions">
      <button id="resetBtn" class="btn btn-secondary" style="margin-right: 8px;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path
            d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
          </path>
        </svg>
        초기화 / 새 파일
      </button>
      <button id="downloadBtn" class="btn btn-primary" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        다운로드
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Left Panel: Page Thumbnails -->
    <aside class="panel panel-left">
      <div class="panel-header">
        <h2>페이지</h2>
        <span id="pageCount" class="badge">0</span>
      </div>
      <div id="thumbnailContainer" class="thumbnail-container">
        <div class="empty-state">
          <p>PDF를 업로드하세요</p>
        </div>
      </div>
    </aside>

    <!-- Center: Canvas Editor -->
    <section class="panel panel-center">
      <!-- Upload Area (shown when no PDF) -->
      <div id="uploadArea" class="upload-area">
        <div class="upload-content">
          <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <path d="M12 18v-6"></path>
            <path d="M9 15l3-3 3 3"></path>
          </svg>
          <h3>PDF 파일을 드래그하거나 클릭하여 업로드</h3>
          <p>NotebookLM에서 생성된 슬라이드 PDF를 선택하세요</p>
          <input type="file" id="fileInput" accept=".pdf" hidden>
          <button class="btn btn-outline">파일 선택</button>
        </div>
      </div>

      <!-- Canvas Container (shown when PDF loaded) -->
      <div id="canvasContainer" class="canvas-container" hidden>
        <canvas id="pdfCanvas"></canvas>
        <canvas id="overlayCanvas"></canvas>
        <div id="selectionBox" class="selection-box" hidden></div>
      </div>

      <!-- Canvas Controls (하단 컨트롤바) -->
      <div id="canvasControls" class="canvas-controls" hidden>
        <button id="fitScreenBtn" class="icon-btn" title="화면에 맞춤">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3">
            </path>
          </svg>
        </button>
        <div class="divider"></div>
        <button id="zoomOutBtn" class="icon-btn" title="축소">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <input type="range" id="zoomSlider" class="zoom-slider" min="25" max="200" value="100" step="5">
        <button id="zoomInBtn" class="icon-btn" title="확대">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="11" y1="8" x2="11" y2="14"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <span id="zoomLevel" class="zoom-level">100%</span>
        <div class="divider"></div>
        <span class="hint">드래그하여 수정할 영역 선택</span>
      </div>
    </section>

    <!-- Right Panel: Text Editor -->
    <aside class="panel panel-right">
      <div class="panel-header">
        <h2>텍스트 편집</h2>
      </div>

      <div id="editorContent" class="editor-content">
        <div class="empty-state">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="15"></line>
            <line x1="15" y1="9" x2="9" y2="15"></line>
          </svg>
          <p>수정할 영역을 선택하세요</p>
        </div>
      </div>

      <!-- Editor Form (shown when area selected) -->
      <div id="editorForm" class="editor-form" hidden>
        <!-- OCR Result -->
        <div class="form-group">
          <label>OCR 인식 결과</label>
          <div id="ocrResult" class="ocr-result">
            <span class="placeholder">인식 중...</span>
          </div>
        </div>

        <!-- Text Input -->
        <div class="form-group">
          <label for="textInput">수정할 텍스트</label>
          <textarea id="textInput" rows="3" placeholder="수정할 텍스트를 입력하세요"></textarea>
        </div>

        <!-- Office Style Ribbon Toolbar -->
        <div class="office-toolbar">
          <!-- Font Group -->
          <div class="toolbar-group">
            <div class="group-label">글꼴</div>
            <div class="group-content">
              <div class="toolbar-row">
                <select id="fontSelect" class="font-family-select">
                  <optgroup label="Pretendard (기본)">
                    <option value="Pretendard|400">Pretendard Regular</option>
                    <option value="Pretendard|500">Pretendard Medium</option>
                    <option value="Pretendard|600">Pretendard SemiBold</option>
                    <option value="Pretendard|700">Pretendard Bold</option>
                  </optgroup>
                  <optgroup label="나눔고딕">
                    <option value="Nanum Gothic|400">나눔고딕</option>
                    <option value="Nanum Gothic|700">나눔고딕 Bold</option>
                  </optgroup>
                  <optgroup label="기타">
                    <option value="Noto Sans KR|400">Noto Sans KR</option>
                    <option value="Malgun Gothic|400">맑은 고딕</option>
                  </optgroup>
                </select>
              </div>
              <div class="toolbar-row">
                <input type="number" id="fontSize" value="24" min="8" max="200" class="font-size-input"
                  title="글꼴 크기 (마우스 휠 사용 가능)">
                <div class="divider"></div>
                <div class="btn-group">
                  <button type="button" id="btnBold" class="toolbar-btn" title="굵게 (Ctrl+B)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                      <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                      <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
                    </svg>
                  </button>
                  <button type="button" id="btnItalic" class="toolbar-btn" title="기울임꼴 (Ctrl+I)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
                      <line x1="19" y1="4" x2="10" y2="4"></line>
                      <line x1="14" y1="20" x2="5" y2="20"></line>
                      <line x1="15" y1="4" x2="9" y2="20"></line>
                    </svg>
                  </button>
                  <button type="button" id="btnUnderline" class="toolbar-btn" title="밑줄 (Ctrl+U)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                      <path d="M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"></path>
                      <line x1="4" y1="21" x2="20" y2="21"></line>
                    </svg>
                  </button>
                </div>
                <div class="divider"></div>
                <input type="color" id="fontColor" value="#000000" class="color-picker-btn" title="글자 색">
              </div>
            </div>
          </div>

          <!-- Paragraph Group -->
          <div class="toolbar-group">
            <div class="group-label">단락</div>
            <div class="group-content">
              <div class="btn-group vertical-center">
                <button type="button" id="btnAlignLeft" class="toolbar-btn active" title="왼쪽 정렬">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="17" y1="10" x2="3" y2="10"></line>
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="17" y1="18" x2="3" y2="18"></line>
                  </svg>
                </button>
                <button type="button" id="btnAlignCenter" class="toolbar-btn" title="중앙 정렬">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="10" x2="6" y2="10"></line>
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="18" y1="18" x2="6" y2="18"></line>
                  </svg>
                </button>
                <button type="button" id="btnAlignRight" class="toolbar-btn" title="오른쪽 정렬">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="21" y1="10" x2="7" y2="10"></line>
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="21" y1="18" x2="7" y2="18"></line>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Appearance Group -->
          <div class="toolbar-group border-none">
            <div class="group-label">효과</div>
            <div class="group-content">
              <div class="opacity-control">
                <label for="bgOpacity">배경 불투명도</label>
                <div class="range-with-value">
                  <input type="range" id="bgOpacity" min="0" max="100" value="100">
                  <span id="bgOpacityValue">100%</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Font Warning -->
        <div id="fontWarning" class="font-warning" hidden>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
          <span>폰트가 설치되지 않았습니다.</span>
          <a id="fontDownloadLink" href="#" target="_blank">다운로드</a>
        </div>

        <!-- Actions -->
        <div class="form-actions">
          <button id="previewBtn" class="btn btn-outline" title="현재 페이지 미리보기">미리보기</button>
          <button id="applyBtn" class="btn btn-primary" title="현재 페이지에만 적용">적용</button>
          <button id="applyAllBtn" class="btn btn-secondary" title="모든 페이지의 같은 위치에 바탕색으로 덮어씁니다 (워터마크 제거)">워터마크
            제거</button>
        </div>
      </div>

      <!-- Overlay List -->
      <div id="overlayList" class="overlay-list" hidden>
        <div class="panel-header">
          <h3>적용된 수정</h3>
          <button id="clearAllBtn" class="btn-text">모두 삭제</button>
        </div>
        <ul id="overlayItems"></ul>
      </div>
    </aside>
  </main>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" hidden>
    <div class="loading-spinner"></div>
    <p id="loadingText">로딩 중...</p>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

  <!-- App Scripts -->
  <script src="js/font-detector.js"></script>
  <script src="js/text-corrector.js"></script>
  <script src="js/pdf-handler.js"></script>
  <script src="js/ocr-handler.js"></script>
  <script src="js/text-overlay.js"></script>
  <script src="js/app.js"></script>
</body>

</html>